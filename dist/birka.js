(function(){'use strict';var c;c={compiler:{},project:{},system:{},ui:{},modal:{}};c.ui.View=function(a){this.element=null;this.name=a||"";this.toolHeader=null};c.ui.View.prototype.initHeader=function(){this.element=document.getElementById("tool-wrapper");this.toolHeader=e.appendNewClassElem(this.element,"div","tool-header");var a=e.appendNewElem(this.toolHeader,"h2");e.setText(a,this.name);this.m_initTitle()};c.ui.View.prototype.m_initTitle=function(){document.title=window.sessionStorage.name};/*
 Copyright (c) 2019.
 @license Creative Commons (BY-NC-SA)
*/
var e={createElem:function(a){return document.createElement(a)},createClassElem:function(a,b){a=document.createElement(a);void 0!==b&&a.setAttribute("class",b);return a},createIdElem:function(a,b){a=document.createElement(a);void 0!==b&&a.setAttribute("id",b);return a},appendNewElem:function(a,b){b=e.createElem(b);a.appendChild(b);return b},appendNewElemAt:function(a,b,d){b=e.createElem(b);this.appendElemAt(a,b,d);return b},appendNewClassElemAt:function(a,b,d,f){b=this.createClassElem(b,d);this.appendElemAt(a,
b,f);return b},appendElemAt:function(a,b,d){a.insertBefore(b,a.children[d])},appendNewClassElem:function(a,b,d){b=e.createClassElem(b,d);a.appendChild(b);return b},appendNewIdElem:function(a,b,d){b=e.createIdElem(b,d);a.appendChild(b);return b},prependNewElem:function(a,b){b=e.createElem(b);a.insertBefore(b,a.firstChild);return b},prependNewClassElem:function(a,b,d){b=e.createClassElem(b,d);a.insertBefore(b,a.firstChild);return b},prependNewIdElem:function(a,b,d){b=e.createIdElem(b,d);a.insertBefore(b,
a.firstChild);return b},img:function(a,b){var d=e.createElem("img");d.setAttribute("src",a);d.setAttribute("alt",b);return d},link:function(a,b){var d=e.createElem("a");d.setAttribute("href",a);a=document.createTextNode(b);d.appendChild(a);return d},p:function(a){var b=e.createElem("p");a=document.createTextNode(a);b.appendChild(a);return b},setText:function(a,b){b=document.createTextNode(b);a.appendChild(b)}};c.project.Toolbar=function(){this.m_tabs=[];this.m_init()};Object.defineProperty(c.project.Toolbar.prototype,"tabs",{get:function(){return this.m_tabs}});
c.project.Toolbar.prototype.m_init=function(){var a=document.getElementById("app-content");a=e.appendNewIdElem(a,"div","nav-wrapper");a=e.appendNewElem(a,"nav");a=e.appendNewElem(a,"ul");var b=[];this.m_tabs=[];for(var d=0;2>d;d++)b.push(e.appendNewElem(a,"li")),this.m_tabs.push(e.appendNewElem(b[d],"a")),this.m_tabs[d].setAttribute("href","#");this.m_tabs[0].innerHTML="Overview";this.m_tabs[0].id="overview";this.m_tabs[0].setAttribute("class","active");this.m_tabs[1].innerHTML="Compiler";this.m_tabs[1].id=
"compiler"};c.project.Modal=function(){this.m_footer=this.m_content=this.m_parent=this.m_options=this.element=null;this.m_buttons=[]};c.project.Modal.prototype.openDialog=function(a,b){this.element=e.appendNewClassElem(document.body,"div","dialog");this.m_parent=b;this.m_options=a;this.init()};
c.project.Modal.prototype.init=function(){var a=this,b=e.appendNewClassElem(this.element,"div","dialog-container"),d=e.appendNewClassElem(b,"div","dialog-header");d=e.appendNewElem(d,"h1");0<this.m_options.title.length&&(d.innerHTML=this.m_options.title);b=e.appendNewElem(b,"form");this.m_content=e.appendNewClassElem(b,"div","dialog-content");this.m_footer=e.appendNewClassElem(b,"div","dialog-footer");this.m_initFooterButtons();"error"===this.m_options.type?this.m_initMessage(this.m_options.type):
"warning"===this.m_options.type?this.m_initMessage(this.m_options.type):"custom"===this.m_options.type&&this.m_initCustom();this.element.addEventListener("click",function(b){"dialog"===b.target.className&&a.m_close()})};c.project.Modal.prototype.m_initMessage=function(a){0<this.m_options.message.length&&(a=e.appendNewClassElem(this.m_content,"p","dialog-"+a),a.innerHTML=this.m_options.message)};c.project.Modal.prototype.m_initCustom=function(){};
c.project.Modal.prototype.m_initFooterButtons=function(){var a=this;this.m_buttons=[];for(var b=0;1>b;b++)this.m_buttons.push(e.appendNewClassElem(this.m_footer,"input","button")),this.m_buttons[b].setAttribute("type","button");this.m_buttons[0].value="OK";this.m_buttons[0].addEventListener("click",function(){a.m_close(this)})};
c.project.Modal.prototype.m_close=function(){var a=document.querySelector(".dialog");a&&a.parentNode.removeChild(this.element);this.m_options.callback&&this.m_options.callback.func&&this.m_options.callback.func(this.m_parent,this.m_options.callback.param)};c.project.CreateModal=function(){this.locationpath=this.browseBtn=this.m_options=null;this.spans=[];this.m_buttons=[];this.paths=[];this.inputs=[];this.callback=null};c.project.CreateModal.dialog=require("electron").remote.dialog;c.project.CreateModal.fs=require("fs");c.project.CreateModal.prototype=Object.create(c.project.Modal.prototype);c.project.CreateModal.prototype.constructor=c.project.CreateModal;
Object.defineProperty(c.project.CreateModal.prototype,"path",{get:function(){return this.locationpath.innerHTML},set:function(a){e.setText(this.locationpath,a)}});c.project.CreateModal.prototype.m_initCustom=function(){this.callback=this.m_options.callback;this.m_initFields()};
c.project.CreateModal.prototype.m_initFooterButtons=function(){for(var a=this,b=0;2>b;b++)this.m_buttons.push(e.createClassElem("input","button")),this.m_footer.appendChild(this.m_buttons[b]),this.m_buttons[b].setAttribute("type","button");this.m_buttons[0].value="Cancel";this.m_buttons[1].value="Create";this.m_buttons[0].addEventListener("click",function(){a.m_close(this)});this.m_buttons[1].addEventListener("click",function(){a.m_checkValidFields()})};
c.project.CreateModal.prototype.m_close=function(){var a=document.querySelector(".dialog");if(a){for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.parentNode.removeChild(this.element)}this.inputs=[];this.paths=[];this.spans=[]};
c.project.CreateModal.prototype.m_initFields=function(){for(var a=[],b=[],d=0;3>d;d++)a.push(e.appendNewElem(this.m_content,"fieldset")),b.push(e.appendNewElem(a[d],"legend"));e.setText(b[0],"Project name");e.setText(b[1],"Project location");e.setText(b[2],"Configuration settings");this.m_initErrorSpans();this.m_initNameField(a[0]);this.m_initLocationField(a[1]);this.m_initConfigField(a[2]);this.m_addListeners()};
c.project.CreateModal.prototype.m_initErrorSpans=function(){for(var a=0;4>a;a++)this.spans.push(e.createClassElem("span","spanerror"))};c.project.CreateModal.prototype.m_initNameField=function(a){var b=e.appendNewClassElem(a,"input","game-name");b.setAttribute("type","text");b.setAttribute("placeholder","Write your project name...");b.setAttribute("minlength","1");a.appendChild(this.spans[0]);this.inputs.push(b)};
c.project.CreateModal.prototype.m_initLocationField=function(a){var b=this,d=e.appendNewClassElem(a,"div","input-field");this.locationpath=e.appendNewClassElem(d,"p","filepath");this.browseBtn=e.appendNewClassElem(d,"input","project-browse");this.browseBtn.setAttribute("type","button");a.appendChild(this.spans[1]);d.addEventListener("click",function(){b.m_chooseLocation(this)})};
c.project.CreateModal.prototype.m_initConfigField=function(a){for(var b=[],d=0;2>d;d++)b.push(e.appendNewElem(a,"label")),this.inputs.push(e.appendNewElem(a,"input")),this.inputs[d].setAttribute("required","");e.appendElemAt(a,this.spans[2],3);e.appendElemAt(a,this.spans[3],6);e.setText(b[0],"Id");this.inputs[1].setAttribute("type","number");this.inputs[1].setAttribute("placeholder","E.g. 0");e.setText(b[1],"Title");this.inputs[2].setAttribute("type","text");this.inputs[2].setAttribute("placeholder",
"Title");this.inputs[2].setAttribute("required","")};
c.project.CreateModal.prototype.m_addListeners=function(){var a=this;this.inputs[0].addEventListener("input",function(){a.m_checkValidTextInput(a.inputs[0],a.spans[0]);a.m_compareInputs(a.inputs[0],a.inputs[2])},!1);this.inputs[0].addEventListener("focusout",function(){""===a.inputs[0].value&&a.m_checkValidTextInput(a.inputs[0],a.spans[0])},!1);this.inputs[1].addEventListener("input",function(b){a.inputs[1].validity.valid?(b.preventDefault(),a.spans[2].innerHTML="",a.spans[2].className="spanerror"):
(a.spans[2].innerHTML="Fill in an id for your project.",a.spans[2].className="spanerror active")},!1);this.inputs[1].addEventListener("focusout",function(){a.inputs[1].validity.valid||(a.spans[2].innerHTML="Fill in an id for your project.",a.spans[2].className="spanerror active")},!1);this.inputs[2].addEventListener("input",function(){a.m_checkValidTextInput(a.inputs[2],a.spans[3]);a.m_compareInputs(a.inputs[2],a.inputs[0])},!1);this.inputs[2].addEventListener("focusout",function(){""===a.inputs[2].value&&
a.m_checkValidTextInput(a.inputs[2],a.spans[3])},!1)};
c.project.CreateModal.prototype.m_checkValidTextInput=function(a,b){""===a.value&&(b.innerHTML="Fill in field.",b.className="spanerror active",a.setCustomValidity("Invalid field"));var d=/^[a-z\u00e5\u00e4\u00f6A-Z\u00c5\u00c4\u00d60-9]+$/;""===a.value||d.test(a.value)||(b.innerHTML="Name should only contain characters: A-\u00d6, 0-9",b.className="spanerror active",a.setCustomValidity("Invalid field."));""!==a.value&&d.test(a.value)&&(b.innerHTML="",b.className="spanerror",a.setCustomValidity(""))};
c.project.CreateModal.prototype.m_compareInputs=function(a,b){""!==a.value&&""!==b.value&&(a.value===b.value?(this.inputs[0].setCustomValidity("Invalid field."),this.spans[0].innerHTML="Project name and title must not be the same.",this.spans[0].className="spanerror active",this.inputs[2].setCustomValidity("Invalid field."),this.spans[3].innerHTML="Project name and title must not be the same.",this.spans[3].className="spanerror active"):(this.m_checkValidTextInput(this.inputs[2],this.spans[3]),this.m_checkValidTextInput(this.inputs[0],
this.spans[0])))};
c.project.CreateModal.prototype.m_checkValidFields=function(){this.m_checkValidTextInput(this.inputs[0],this.spans[0]);this.m_checkValidTextInput(this.inputs[2],this.spans[3]);this.inputs[1].validity.valid||(this.spans[2].innerHTML="Fill in an id for your project.",this.spans[2].className="spanerror active");""===this.path&&(this.spans[1].innerHTML="Please choose a location for your project.",this.spans[1].className="spanerror active");this.inputs[0].validity.valid&&this.inputs[1].validity.valid&&this.inputs[2].validity.valid&&
""!==this.path&&this.m_checkIfFolderExists()};
c.project.CreateModal.prototype.m_checkIfFolderExists=function(){var a=this;if(!1===a.m_walkDir(a.path,a.path+"/"+a.inputs[0].value)){var b=a.path.replace(/^.*[\\\/]/,"");c.project.CreateModal.dialog.showMessageBox({title:"Warning",type:"warning",message:"A file or folder with this name already exists in the folder "+b+". Replacing it will overwrite its current contents.",icon:"./src/img/error.png",buttons:["Overwrite","Cancel"],cancelId:1},function(b){1!==b&&0===b&&(a.m_saveRecent(!0),a.m_save())})}else a.m_saveRecent(!1),
a.m_save()};c.project.CreateModal.prototype.m_saveRecent=function(a){null!==window.localStorage.getItem("recentProjects")?this.m_saveRecentUnshift(a):window.localStorage.setItem("recentProjects",JSON.stringify({projects:[this.locationpath.innerHTML+"/"+this.inputs[0].value]}))};
c.project.CreateModal.prototype.m_saveRecentUnshift=function(a){var b=JSON.parse(window.localStorage.getItem("recentProjects"));if(!1===a)b.projects.unshift(this.path+"/"+this.inputs[0].value);else{a=this.path+"/"+this.inputs[0].value;for(var d=0;d<b.projects.length;d++)b.projects[d].toLowerCase()===a.toLowerCase()&&b.projects.splice(d,1);b.projects.unshift(a)}5<b.projects.length&&b.projects.splice(5);window.localStorage.setItem("recentProjects",JSON.stringify(b))};
c.project.CreateModal.prototype.m_save=function(){var a={name:this.inputs[0].value,location:this.path,id:this.inputs[1].value,title:this.inputs[2].value};window.sessionStorage.setItem("loaded","true");window.sessionStorage.setItem("name",a.name);window.sessionStorage.setItem("projectLocation",a.location+"/"+a.name);window.sessionStorage.setItem("output",a.location+"/"+a.name+"/src/data");(new c.project.Projectdirectory(a)).create();this.m_close();this.callback(this.m_parent)};
c.project.CreateModal.prototype.m_walkDir=function(a,b){var d=[],f=!0;b=b.toLowerCase();c.project.CreateModal.fs.readdirSync(a).forEach(function(b){b=c.project.ProjectManager.path.join(a,b);b.match(/(^|\/)\.[^\/\.]/g)||d.push(b)});for(var g=0;g<d.length;g++)d[g].toLowerCase()===b&&(f=!1);return f};
c.project.CreateModal.prototype.m_chooseLocation=function(){var a=this;c.project.CreateModal.dialog.showOpenDialog({title:"Select a folder",properties:["openDirectory"]},function(b){void 0===b||0===b.length?""===a.path&&(a.spans[1].innerHTML="Please choose a location for your project.",a.spans[1].className="spanerror active"):(0<a.spans.length&&(a.spans[1].innerHTML="",a.spans[1].className="spanerror"),a.locationpath.innerHTML=b[0])})};c.project.Projectdirectory=function(a){this.m_project=a.name||"";this.m_output=a.location+"/"+a.name||"";this.m_title=a.title||"";this.m_id=a.id||"";this.m_resquestQueue=[];this.m_request={};this.m_folders="/bin-debug/ /lib/ /src/data/ /src/scene/ /src/scope/ /src/system/".split(" ");this.m_files=[{name:"Main.js",template:"/templates/Main.txt",directory:"/src/system/"},{name:"rune.js",url:"https://raw.githubusercontent.com/VectorPanic/rune/master/dist/rune.js",template:"",directory:"/lib/"},{name:"SceneMain.js",
template:"/templates/SceneMain.txt",directory:"/src/scene/"},{name:"Alias.js",template:"/templates/Alias.txt",directory:"/src/scope/"},{name:"Manifest.js",template:"/templates/Manifest.txt",directory:"/src/scope/"},{name:"Index.html",template:"/templates/Index.txt",directory:"/bin-debug/"}]};c.project.Projectdirectory.fs=require("fs");c.project.Projectdirectory.mkdirp=require("mkdirp");c.project.Projectdirectory.dialog=require("electron").remote.dialog;
c.project.Projectdirectory.prototype.create=function(){this.m_initFolders()};c.project.Projectdirectory.prototype.m_initFolders=function(){for(var a=0;a<this.m_folders.length;a++)this.m_checkDirectory(this.m_folders[a]);this.m_initFiles()};c.project.Projectdirectory.prototype.m_initFiles=function(){this.m_resquestQueue=this.m_files;this.m_processRequestQueue()};
c.project.Projectdirectory.prototype.m_processRequestQueue=function(){0<this.m_resquestQueue.length?(this.m_request=this.m_resquestQueue.shift(),this.m_processRequest()):this.m_onComplete()};c.project.Projectdirectory.prototype.m_processRequest=function(){"rune.js"==this.m_request.name?this.m_getURLdata():this.m_readTemplate()};
c.project.Projectdirectory.prototype.m_getURLdata=function(){var a=this,b=new XMLHttpRequest;b.open("GET",this.m_request.url,!0);b.onreadystatechange=function(){4===b.readyState&&(200===b.status?a.m_writeFile(this.responseText):a.m_onError("Birka failed to fetch Rune.js from server. Try again. If error remains, please contact developer."))};b.send()};c.project.Projectdirectory.prototype.m_checkDirectory=function(a){c.project.Projectdirectory.mkdirp.sync(this.m_output+a)};
c.project.Projectdirectory.prototype.m_createFileData=function(a){a=a.replace(/%APP%/g,this.m_project);"Main.js"==this.m_request.name&&(a=a.replace(/%TITLE%/g,this.m_title),a=a.replace(/%ID%/g,this.m_id));this.m_writeFile(a)};
c.project.Projectdirectory.prototype.m_writeFile=function(a){var b=this,d=b.m_request.name?b.m_request.name:"unidentified";c.project.Projectdirectory.fs.writeFile(this.m_output+this.m_request.directory+this.m_request.name,a,function(a){a?b.m_onError("Birka could not save "+d+" project file. Try again. If error remains, please contact developer."):b.m_processRequestQueue()})};
c.project.Projectdirectory.prototype.m_readTemplate=function(){var a=this;c.compiler.Resourcefile.fs.readFile(__dirname+this.m_request.template.toString(),"utf8",function(b,d){b?a.m_onError("Birka could not read template for "+(a.m_request.name?a.m_request.name:"unidentified")+" project file. Try again. If error remains, please contact developer."):a.m_createFileData(d)})};
c.project.Projectdirectory.prototype.m_onComplete=function(){c.project.Projectdirectory.dialog.showMessageBox({title:"Info",message:'New project directory created at "'+this.m_output+'" for the project "'+this.m_project+'".',buttons:["OK"]});this.m_reset()};c.project.Projectdirectory.prototype.m_onError=function(a){c.project.Projectdirectory.dialog.showMessageBox({title:"Error",message:a,icon:"./src/img/error.png",buttons:["OK"]});this.m_reset()};
c.project.Projectdirectory.prototype.m_reset=function(){this.m_request=this.m_resquestQueue=null};c.project.ProjectManagerView=function(){this.chooseBtn=this.createBtn=null;this.linkItems=[];this.m_element=this.m_toolWrapper=null};c.project.ProjectManagerView.prototype.init=function(){this.m_initHeader();this.m_initButtons();this.m_initRecent()};c.project.ProjectManagerView.prototype.removeElems=function(){for(;this.m_toolWrapper.hasChildNodes();)this.m_toolWrapper.removeChild(this.m_toolWrapper.firstChild)};
c.project.ProjectManagerView.prototype.m_initHeader=function(){this.m_toolWrapper=document.getElementById("app-content");this.m_element=e.appendNewClassElem(this.m_toolWrapper,"div","project-manager");var a=e.appendNewClassElem(this.m_element,"div","project-manager-col-1"),b=e.appendNewElem(a,"h2");e.setText(b,"Let's get started!");a=e.appendNewElem(a,"p");e.setText(a,"Start by selecting an existing project or create a new project.")};
c.project.ProjectManagerView.prototype.m_initButtons=function(){var a=document.querySelector(".project-manager-col-1"),b=e.appendNewClassElem(a,"div","project-manager-buttons");a=[];for(var d=0;2>d;d++)a.push(e.appendNewElem(b,"input")),a[d].setAttribute("type","button");b=e.appendNewElemAt(b,"h3",1);e.setText(b,"OR");a[0].setAttribute("value","Choose project...");a[1].setAttribute("value","Create new project");this.chooseBtn=a[0];this.createBtn=a[1]};
c.project.ProjectManagerView.prototype.m_initRecent=function(){var a=e.appendNewClassElem(this.m_element,"div","project-manager-col-2");a=e.appendNewClassElem(a,"div","project-manager-recent");var b=e.appendNewElem(a,"h3");e.setText(b,"Open recent project");b=[];var d=[],f=[];if(null!==window.localStorage.getItem("recentProjects")){var g=JSON.parse(window.localStorage.getItem("recentProjects"));if(0<g.projects.length)for(var h=0;h<g.projects.length;h++){this.linkItems.push(e.appendNewClassElem(a,
"a","project-manager-list-item"));this.linkItems[h].setAttribute("href","#");b.push(e.appendNewElem(this.linkItems[h],"div"));d.push(e.appendNewElem(b[h],"h4"));var k=g.projects[h].replace(/^.*[\\\/]/,"");e.setText(d[h],k);f.push(e.appendNewElem(b[h],"p"));e.setText(f[h],g.projects[h])}else a=e.appendNewElem(a,"p"),e.setText(a,"...")}};c.project.Project=function(){this.m_toolWrapper=this.m_toolbar=this.m_appContent=null;this.m_tabs=[];this.m_activeTool=null};c.project.Project.prototype.init=function(){this.m_appContent=document.getElementById("app-content");this.m_clearWindow();this.m_initUI()};
c.project.Project.prototype.m_initUI=function(){var a=this;this.m_toolbar=new c.project.Toolbar;this.m_tabs=this.m_toolbar.tabs;for(var b=0;b<this.m_tabs.length;b++)this.m_tabs[b].addEventListener("click",function(b){a.changeTool(b,this)});this.m_toolWrapper=e.appendNewIdElem(this.m_appContent,"div","tool-wrapper");this.m_initProjectDetails();this.m_initTitle()};
c.project.Project.prototype.m_initProjectDetails=function(){e.appendNewElem(this.m_toolWrapper,"h2");var a=e.appendNewClassElem(this.m_toolWrapper,"div","tool-header"),b=e.appendNewElem(a,"h2");e.setText(b,"Project name: "+window.sessionStorage.name);a=e.appendNewClassElem(a,"input","project-update-sdk-btn");a.setAttribute("type","button");a.setAttribute("value","Uppdatera SDK version");this.m_addListeners()};c.project.Project.prototype.m_initTitle=function(){document.title=window.sessionStorage.name};
c.project.Project.prototype.m_addListeners=function(){document.querySelector(".project-update-sdk-btn").addEventListener("click",function(){alert("Ers\u00e4tt denna alert med anrop till annan metod i: birka.project.Project.prototype.m_addListeners");console.log(window.sessionStorage)})};c.project.Project.prototype.changeTool=function(a,b){if(!b.classList.contains("active")){for(var d=0;d<this.m_tabs.length;d++)this.m_tabs[d].classList.remove("active");b.classList.toggle("active");this.startTool(a.target.id)}};
c.project.Project.prototype.startTool=function(a){switch(a){case "overview":this.removeTool();this.m_activeTool=new c.project.Project;this.m_activeTool.init();break;case "compiler":this.removeTool(),this.m_activeTool=new c.compiler.Compiler,this.m_activeTool.init()}};c.project.Project.prototype.m_clearWindow=function(){for(;this.m_appContent.hasChildNodes();)this.m_appContent.removeChild(this.m_appContent.firstChild)};
c.project.Project.prototype.removeTool=function(){for(;this.m_toolWrapper.hasChildNodes();)this.m_toolWrapper.removeChild(this.m_toolWrapper.firstChild);this.m_activeTool=null};c.project.ProjectManager=function(a){this.callback=a;this.m_view=null;this.m_paths=[]};c.project.ProjectManager.dialog=require("electron").remote.dialog;c.project.ProjectManager.fs=require("fs");c.project.ProjectManager.path=require("path");c.project.ProjectManager.CModal=new c.project.CreateModal;c.project.ProjectManager.Modal=new c.project.Modal;c.project.ProjectManager.prototype.init=function(){this.m_initUI()};
c.project.ProjectManager.prototype.m_initUI=function(){this.m_view=new c.project.ProjectManagerView(this.toolWrapper);this.m_view.init();this.m_addListeners()};
c.project.ProjectManager.prototype.m_addListeners=function(){var a=this;this.m_view.createBtn.addEventListener("click",function(){a.m_createProject()});this.m_view.chooseBtn.addEventListener("click",function(){a.m_openProject()});for(var b=0;b<this.m_view.linkItems.length;b++)this.m_view.linkItems[b].addEventListener("click",function(){a.m_loadProject(this.querySelector("p").innerHTML)});require("electron").ipcRenderer.on("create",function(){a.m_createProject()});require("electron").ipcRenderer.on("open",
function(){a.m_openProject()})};c.project.ProjectManager.prototype.m_createProject=function(){c.project.ProjectManager.CModal.openDialog({type:"custom",title:"Create project",callback:this.m_saveProject},this)};c.project.ProjectManager.prototype.m_saveProject=function(a){var b=new c.project.Project;a.callback(b)};
c.project.ProjectManager.prototype.m_openProject=function(){var a=this;c.project.ProjectManager.dialog.showOpenDialog({title:"Select a folder",properties:["openDirectory"]},function(b){void 0!==b&&0!==b.length&&a.m_loadProject(b[0])})};
c.project.ProjectManager.prototype.m_loadProject=function(a){if(!1!==this.m_checkIfFolder(a))if(this.m_checkProjectValidity(a,this.m_walkDir(a))){var b=a.replace(/^.*[\\\/]/,"");window.sessionStorage.setItem("name",b);window.sessionStorage.setItem("projectLocation",a);window.sessionStorage.setItem("output",a+"/src/data");window.sessionStorage.setItem("loaded","true");if(null!==window.localStorage.getItem("recentProjects")){b=JSON.parse(window.localStorage.getItem("recentProjects"));for(var d=0;d<
b.projects.length;d++)b.projects[d].toLowerCase()===a.toLowerCase()&&b.projects.splice(d,1);b.projects.unshift(a);5<b.projects.length&&b.projects.splice(5);window.localStorage.setItem("recentProjects",JSON.stringify(b))}else null===window.localStorage.getItem("recentProjects")&&(b={projects:[a]},window.localStorage.setItem("recentProjects",JSON.stringify(b)),console.log(window.localStorage.getItem("recentProjects")));this.m_saveProject(this)}else this.m_showError("Not a working project.","Missing Main.js and/or data folder.")};
c.project.ProjectManager.prototype.m_removeRecent=function(a,b){for(var d=JSON.parse(window.localStorage.getItem("recentProjects")),f=0;f<a.m_view.linkItems.length;f++)a.m_view.linkItems[f].querySelector("p").innerHTML===b&&(a.m_view.linkItems[f].parentNode.removeChild(a.m_view.linkItems[f]),a.m_view.linkItems.splice(f,1));for(a=0;a<d.projects.length;a++)b===d.projects[a]&&d.projects.splice(a,1);window.localStorage.setItem("recentProjects",JSON.stringify(d))};
c.project.ProjectManager.prototype.m_checkIfFolder=function(a){try{c.project.ProjectManager.fs.readdirSync(a)}catch(b){if("ENOENT"===b.code)return c.project.ProjectManager.Modal.openDialog({type:"error",title:"Missing project folder",message:"The project folder has either been removed, or moved to a new location.",callback:{func:this.m_removeRecent,param:a}},this),!1}};
c.project.ProjectManager.prototype.m_walkDir=function(a){var b=this;c.project.ProjectManager.fs.readdirSync(a).forEach(function(d){d=c.project.ProjectManager.path.join(a,d);c.project.ProjectManager.fs.lstatSync(d).isDirectory()?(b.m_walkDir(d),b.m_paths.push(d)):d.match(/(^|\/)\.[^\/\.]/g)||b.m_paths.push(d)})};c.project.ProjectManager.prototype.m_checkProjectValidity=function(a){if(-1<this.m_paths.indexOf(a+"/src/system/Main.js")){if(-1<this.m_paths.indexOf(a+"/src/data"))return!0}else return!1};
c.project.ProjectManager.prototype.m_showError=function(a,b){c.project.ProjectManager.Modal.openDialog({type:"error",title:a,message:[b]})};c.compiler.Resourcefile=function(a,b){this.m_project=a||"";this.m_output=b||"";this.m_resquestQueue=[];this.m_request={};this.m_tempArr=[]};c.compiler.Resourcefile.fs=require("fs");c.compiler.Resourcefile.dialog=require("electron").remote.dialog;c.compiler.Resourcefile.prototype.compile=function(a){0<a.length?(this.m_resquestQueue=a,this.m_processRequestQueue()):this.m_readTemplate()};
c.compiler.Resourcefile.prototype.m_processRequestQueue=function(){0<this.m_resquestQueue.length?(this.m_request=this.m_resquestQueue.shift(),this.m_processRequest()):this.m_readTemplate()};c.compiler.Resourcefile.prototype.m_processRequest=function(){this.m_generateBase64(this.m_request.blob,this.m_request.name)};
c.compiler.Resourcefile.prototype.m_generateBase64=function(a,b){var d=this,f=new FileReader;f.onload=function(){d.m_generateResponse(b,f.result);d.m_resquest=null;d.m_processRequestQueue()};f.onerror=function(){f.abort();d.onError("Birka failed to read a resource file. Check ingoing resources and try again. If error remains, please contact developer.")};f.readAsDataURL(a)};c.compiler.Resourcefile.prototype.m_generateResponse=function(a,b){this.m_tempArr.push('this.create("'+a+'", "'+b+'");')};
c.compiler.Resourcefile.prototype.m_saveDataToFile=function(a){a=a.replace(/%APP%/g,this.m_project);var b=this.m_tempArr.join("\n\t");a=a.replace("%RESOURCES%",b);this.m_writeFile(a)};c.compiler.Resourcefile.prototype.m_writeFile=function(a){var b=this;c.compiler.Resourcefile.fs.writeFile(this.m_output+"/src/data/Resources.js",a,function(a){a?b.m_onError("Birka could not save resource file. Try again. If error remains, please contact developer."):b.m_onComplete()})};
c.compiler.Resourcefile.prototype.m_readTemplate=function(){var a=this;c.compiler.Resourcefile.fs.readFile(__dirname+"/templates/Resources.txt".toString(),"utf8",function(b,d){b?a.m_onError("Birka could not read template for resource file. Try again. If error remains, please contact developer."):a.m_saveDataToFile(d)})};c.compiler.Resourcefile.prototype.m_onError=function(a){c.compiler.Resourcefile.dialog.showMessageBox({title:"Error",message:a,icon:"./src/img/error.png",buttons:["OK"]});this.m_reset()};
c.compiler.Resourcefile.prototype.m_onComplete=function(){var a='"'+this.m_output+'/src/data/Resources.js"',b=this.m_getFilesize();c.compiler.Resourcefile.dialog.showMessageBox({title:"Info",message:"The resources has been compiled and saved to "+a+" with a size of "+b+" KB.",buttons:["OK"]});this.m_reset()};c.compiler.Resourcefile.prototype.m_getFilesize=function(){var a=c.compiler.Resourcefile.fs.statSync(this.m_output+"/src/data/Resources.js").size;return Math.round(a/1E3)};
c.compiler.Resourcefile.prototype.m_reset=function(){this.m_tempArr=[];this.m_resquestQueue=[];this.m_request={};this.m_output=this.m_project=""};c.compiler.CompilerView=function(){c.ui.View.call(this,"Compiler");this.compileBtn=this.footer=this.tableElem=this.fileList=this.refreshBtn=this.outputPath=this.inputPath=this.inputBtn=this.form=null};c.compiler.CompilerView.prototype=Object.create(c.ui.View.prototype);c.compiler.CompilerView.prototype.constructor=c.compiler.CompilerView;Object.defineProperty(c.compiler.CompilerView.prototype,"setWarnings",{set:function(a){this.m_warningsElem.innerHTML=a.toString()}});
Object.defineProperty(c.compiler.CompilerView.prototype,"setErrors",{set:function(a){this.m_errorsElem.innerHTML=a.toString()}});c.compiler.CompilerView.prototype.init=function(){this.initHeader();this.m_renderForm();this.m_renderFileList();this.m_renderFooter()};
c.compiler.CompilerView.prototype.m_renderForm=function(){this.form=e.appendNewElem(this.toolHeader,"form");this.form.method="post";this.form.enctype="multipart/form-data";for(var a=[],b=[],d=[],f=[],g=0;2>g;g++)b.push(e.appendNewClassElem(this.form,"div","input-field")),d.push(e.appendNewClassElem(b[g],"div","output-row")),a.push(e.appendNewElem(d[g],"label")),f.push(e.appendNewElem(d[g],"div")),f[g].setAttribute("class","filepath");this.inputBtn=e.prependNewClassElem(b[0],"input","browse");this.inputBtn.setAttribute("type",
"button");this.inputBtn.setAttribute("value","Browse...");this.inputBtn.id="selectInputBtn";a[0].setAttribute("for","selectInputBtn");a[0].innerText="Select input folder";a[1].innerText="Output path";this.refreshBtn=e.appendNewClassElem(b[0],"input","refresh");this.refreshBtn.setAttribute("type","button");this.inputPath=f[0];this.outputPath=f[1];this.inputPath.innerHTML="No folder chosen.";this.outputPath.innerHTML=void 0===window.sessionStorage.output||""===window.sessionStorage.output?"No folder chosen.":
window.sessionStorage.output};
c.compiler.CompilerView.prototype.m_renderFileList=function(){this.fileList=e.appendNewClassElem(this.element,"div","fileIndex");var a=e.appendNewElem(this.fileList,"h3");e.setText(a,"Files");this.tableElem=e.appendNewElem(this.fileList,"table");a=e.appendNewElem(this.tableElem,"thead");a=e.appendNewElem(a,"tr");for(var b=[],d=0;5>d;d++)b.push(e.appendNewElem(a,"th"));e.setText(b[0],"Incl.");e.setText(b[1],"File path");e.setText(b[2],"Name");e.setText(b[3],"File size");e.setText(b[4],"")};
c.compiler.CompilerView.prototype.m_renderFooter=function(){this.footer=e.appendNewClassElem(this.element,"div","footer");var a=e.appendNewClassElem(this.footer,"div","problems-container"),b=e.appendNewClassElem(a,"div","problems-error");this.m_errorsElem=b.appendChild(e.p("0"));b.appendChild(e.p(" error(s) "));a=e.appendNewClassElem(a,"div","problems-warning");this.m_warningsElem=a.appendChild(e.p("0"));a.appendChild(e.p(" warning(s)"));this.compileBtn=e.appendNewElem(this.footer,"input");this.compileBtn.setAttribute("type",
"submit");this.compileBtn.setAttribute("value","Compile");this.compileBtn.setAttribute("id","compileBtn")};c.compiler.File=function(a,b){this.blob=a;this.path=b;this.status=[];this.name=null;this.size="";this.init()};c.compiler.File.ALLOWED_FILE_TYPES="image/png image/jpeg image/gif audio/ogg audio/mpeg application/xml application/json".split(" ");Object.defineProperty(c.compiler.File.prototype,"setStatus",{set:function(a){this.status.push(a)}});Object.defineProperty(c.compiler.File.prototype,"setName",{set:function(a){this.name=a}});
c.compiler.File.prototype.init=function(){this.name=this.m_getFileName(this.path);this.size=this.m_bytesToSize(this.blob.size)};c.compiler.File.prototype.removeError=function(a){for(var b=0;b<this.status.length;b++)this.status[b]===a&&this.status.splice(b,1)};c.compiler.File.prototype.isDuplicate=function(){for(var a=!1,b=0;b<this.status.length;b++)a=2===this.status[b]?!0:!1;return a};c.compiler.File.prototype.hasWarning=function(){for(;0<this.status.length;)return 10<=this.status[0]?!0:!1};
c.compiler.File.prototype.m_checkStatus=function(){0>c.compiler.File.ALLOWED_FILE_TYPES.indexOf(this.blob.type)&&(this.setStatus=1);("image/png"===this.blob.type||"image/jpg"===this.blob.type||"image/gif"===this.blob.type)&&11E5<this.blob.size&&(this.setStatus=10);("audio/ogg"===this.blob.type||"audio/mpeg"===this.blob.type)&&33E5<this.blob.size&&(this.setStatus=11)};
c.compiler.File.prototype.m_getFileName=function(a){a=a.replace(/^.*[\\\/]/,"");a=a.split(".").slice(0,-1).join(".");-1<a.indexOf(" ")&&(a=a.replace(" ","_"),this.setStatus=12);return a};c.compiler.File.prototype.m_bytesToSize=function(a){if(0===a)return"0 Byte";var b=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,b),2)+" "+["B","kB","MB","GB","TB"][b]};c.compiler.Message=function(){this.tbody=null;this.messages=[]};c.compiler.Message.prototype.create=function(a,b){this.tbody=e.createClassElem("tbody","message");a.insertBefore(this.tbody,a.children[b+1])};c.compiler.Message.prototype.addMessage=function(a){if(0<a.length)for(var b=0;b<a.length;b++){var d=new c.compiler.MessageRow(this.tbody,a[b]);d.setStatus=a[b];this.messages.push(d)}else d=new c.compiler.MessageRow(this.tbody,a),d.setStatus=a,this.messages.push(d);this.tbody.style.display="none"};
c.compiler.Message.prototype.addMessageAt=function(a){for(var b=0;b<a.length;b++){var d=new c.compiler.MessageRow(this.tbody,a[b]);d.setStatus=a[b];this.messages.push(d)}this.tbody.style.display="none"};c.compiler.Message.prototype.removeDup=function(){for(var a=0;a<this.messages.length;a++)2===this.messages[a].status&&(this.tbody.removeChild(this.messages[a].element),this.messages.splice(a,1))};
c.compiler.Message.prototype.containsDuplicateErr=function(){for(var a=!1,b=0;b<this.messages.length;b++)a=2===this.messages[b].status?!0:!1;return a};c.compiler.MessageRow=function(a,b){this.element=e.appendNewClassElem(a,"tr","msg");this.create(b);this.status=0};Object.defineProperty(c.compiler.MessageRow.prototype,"setStatus",{set:function(a){this.status=a}});c.compiler.MessageRow.prototype.create=function(a){this.setStyle(a);var b=e.appendNewElem(this.element,"td");b.setAttribute("colspan","5");b.innerHTML=this.codeToMessage(a)};c.compiler.MessageRow.prototype.m_toggleDisabled=function(a){this.element.style.display=a?"none":"table-row"};
c.compiler.MessageRow.prototype.codeToMessage=function(a){var b="";switch(a){case 1:b="Invalid file type.";break;case 2:b="Duplicate file name.";break;case 10:b="File size exceeds 1MB.";break;case 11:b="File size exceeds 3MB";break;case 12:b="Spaces not allowed in name. The name has been modified from the original filename."}return b};
c.compiler.MessageRow.prototype.setStyle=function(a){switch(a){case 0:this.element.classList.remove("error");break;case 1:this.element.classList.add("error");break;case 2:this.element.classList.add("error");break;case 10:this.element.classList.add("warning");break;case 11:this.element.classList.add("warning");break;case 12:this.element.classList.add("warning")}};c.compiler.TableRow=function(a){this.tbody=e.appendNewElem(a,"tbody");this.element=e.appendNewElem(this.tbody,"tr");this.include=!0;this.m_parentTable=a;this.tds=[];this.messageRow=this.textInput=null};c.compiler.TableRow.prototype.create=function(a){this.m_createCells(a);this.m_makeCollapsible();0<a.status.length&&this.m_changeStatus(a.status)};c.compiler.TableRow.prototype.m_createRow=function(){};
c.compiler.TableRow.prototype.m_createCells=function(a){for(var b=0;5>b;b++)this.tds.push(e.appendNewElem(this.element,"td"));this.m_addCheckbox(this.tds[0]);this.tds[1].innerHTML=a.path;this.m_inputName(this.tds[2],a.name);this.tds[3].innerHTML=a.size;this.tds[4].classList.add("coll-cell")};
c.compiler.TableRow.prototype.m_addCheckbox=function(a){var b=this;a=e.appendNewClassElem(a,"label","check-container");var d=e.appendNewClassElem(a,"input","checkbox");d.setAttribute("type","checkbox");d.setAttribute("checked","checked");d.addEventListener("click",function(){b.m_toggleInclude(this)});e.appendNewClassElem(a,"span","checkmark")};c.compiler.TableRow.prototype.m_toggleInclude=function(){this.element.classList.toggle("ignored");this.include=!0!==this.include};
c.compiler.TableRow.prototype.m_inputName=function(a,b){this.textInput=e.appendNewElem(a,"input");this.textInput.setAttribute("type","text");this.textInput.setAttribute("value",b);this.textInput.setAttribute("required","");this.textInput.addEventListener("keypress",function(a){32===a.keyCode&&a.preventDefault()})};c.compiler.TableRow.prototype.m_changeStatus=function(a){var b=0;if(0<a.length)for(var d=0;d<a.length;d++){if(1===a[d]||2===a[d])b=1;10<=a[d]&&(b=10)}this.m_styleRow(b)};
c.compiler.TableRow.prototype.m_styleRow=function(a){switch(a){case 0:this.element.classList.remove("error");break;case 1:this.element.classList.add("error");break;case 2:this.element.classList.add("error");break;case 10:this.element.classList.add("warning");break;case 11:this.element.classList.add("warning");break;case 12:this.element.classList.add("warning");break;case 5:this.element.classList.remove("warning"),this.element.classList.add("error")}};
c.compiler.TableRow.prototype.m_toggleDisabled=function(a){a&&(this.messageRow.style.display="none");this.m_makeCollapsible()};c.compiler.TableRow.prototype.m_makeCollapsible=function(){var a=this;this.tds[4].addEventListener("click",function(){a.m_collapse(this)})};
c.compiler.TableRow.prototype.m_collapse=function(a){if(this.element.classList.contains("error")||this.element.classList.contains("warning"))a.classList.toggle("coll-active"),a=this.tbody.nextElementSibling,"table-row-group"===a.style.display?a.style.display="none":"none"===a.style.display&&(a.style.display="table-row-group")};c.compiler.Compiler=function(){this.m_view=null;this.m_files=[];this.m_warnings=this.m_errors=0;this.modal=null};c.compiler.Compiler.dialog=require("electron").remote.dialog;c.compiler.Compiler.fs=require("fs");c.compiler.Compiler.path=require("path");c.project.ProjectManager.Modal=new c.project.Modal;c.compiler.Compiler.prototype.init=function(){this.m_initUI()};c.compiler.Compiler.prototype.m_initUI=function(){this.m_view=new c.compiler.CompilerView;this.m_view.init();this.m_addListeners()};
c.compiler.Compiler.prototype.m_addListeners=function(){var a=this;this.m_view.inputBtn.addEventListener("click",function(){a.m_uploadFiles(this)});this.m_view.compileBtn.addEventListener("click",function(){a.m_compile(this)})};
c.compiler.Compiler.prototype.m_compile=function(){for(var a=[],b=0;b<this.m_files.length;b++)!0===this.m_files[b].row.include&&a.push(this.m_files[b].file);for(b=0;b<a.length;b++)if(0<a[b].status.length)for(var d=0;d<a[b].status.length;d++){if(1===a[b].status[d]||2===a[b].status[d]){c.project.ProjectManager.Modal.openDialog({type:"error",title:"Can't compile",message:"Your selected folder contains errors."});return}}else if(""===a[b].name){c.project.ProjectManager.Modal.openDialog({type:"error",
title:"Can't compile",message:"One or more resources is not named."});return}(new c.compiler.Resourcefile(window.sessionStorage.name,window.sessionStorage.projectLocation)).compile(a)};
c.compiler.Compiler.prototype.m_uploadFiles=function(){var a=this;c.compiler.Compiler.dialog.showOpenDialog({title:"Select a folder",properties:["openDirectory"]},function(b){void 0===b||0===b.length?console.log("No destination folder selected"):(a.m_emptyTable(),a.m_view.inputPath.innerHTML=b[0],a.m_walkDir(b[0]))});this.m_view.refreshBtn.addEventListener("click",function(){a.m_refresh(this)})};
c.compiler.Compiler.prototype.m_refresh=function(){""!==this.m_view.inputPath.innerHTML&&(this.m_emptyTable(),this.m_walkDir(this.m_view.inputPath.innerHTML))};c.compiler.Compiler.prototype.m_emptyTable=function(){this.m_warnings=0;this.m_view.setWarnings=this.m_warnings;this.m_errors=0;for(this.m_view.setErrors=this.m_errors;1<this.m_view.tableElem.childNodes.length;)this.m_view.tableElem.removeChild(this.m_view.tableElem.lastChild);this.m_files=[]};
c.compiler.Compiler.prototype.m_walkDir=function(a){var b=this;c.compiler.Compiler.fs.readdirSync(a).forEach(function(d){d=c.compiler.Compiler.path.join(a,d);c.compiler.Compiler.fs.lstatSync(d).isDirectory()?b.m_walkDir(d):d.match(/(^|\/)\.[^\/\.]/g)||b.m_requestFile(d)})};
c.compiler.Compiler.prototype.m_requestFile=function(a){var b=this,d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="blob";d.onreadystatechange=function(){4===d.readyState&&(200===d.status?b.m_getData(new c.compiler.File(this.response,a)):console.log("Error..."))};d.send()};
c.compiler.Compiler.prototype.m_getData=function(a){var b=this;a.m_checkStatus();0<this.m_files.length&&b.m_checkIfDuplicate(a.name)&&(a.setStatus=2,this.m_checkForNewDuplicates(a.name));var d=new c.compiler.TableRow(this.m_view.tableElem);d.create(a);d.textInput.addEventListener("input",function(a){b.m_changeName(a,d)});if(0<a.status.length){var f=new c.compiler.Message(this.m_view.tableElem);f.create(this.m_view.tableElem,this.m_view.tableElem.childNodes);f.addMessage(a.status);for(var g=0;g<a.status.length;g++)this.m_incrementException(a.status[g])}this.m_files.push({file:a,
row:d,message:f})};c.compiler.Compiler.prototype.m_incrementException=function(a){0<a&&10>a&&(this.m_errors++,this.m_view.setErrors=this.m_errors);10<=a&&(this.m_warnings++,this.m_view.setWarnings=this.m_warnings)};c.compiler.Compiler.prototype.m_decrementException=function(a){0<a&&10>a&&(this.m_errors--,this.m_view.setErrors=this.m_errors);10<=a&&(this.m_warnings--,this.m_view.setWarnings=this.m_warnings)};
c.compiler.Compiler.prototype.m_checkIfDuplicate=function(a){for(var b=!1,d=0;d<this.m_files.length;d++)this.m_files[d].file.name===a&&(b=!0);return b};
c.compiler.Compiler.prototype.m_changeName=function(a,b){for(a=0;a<this.m_files.length;a++)if(this.m_files[a].row===b){var d=this.m_files[a];this.m_checkIfDuplicate(b.textInput.value)&&d.file.isDuplicate()?(this.m_checkRemainingDuplicates(d.file.name),this.m_checkForNewDuplicates(b.textInput.value)):this.m_checkIfDuplicate(b.textInput.value)&&!d.file.isDuplicate()?(this.m_checkForNewDuplicates(b.textInput.value),this.m_addDuplicateError(d,a+2)):!this.m_checkIfDuplicate(b.textInput.value)&&d.file.isDuplicate()&&
(this.m_removeDuplicateError(d),this.m_checkRemainingDuplicates(d.file.name));this.m_files[a].file.setName=b.textInput.value}};c.compiler.Compiler.prototype.m_checkRemainingDuplicates=function(a){for(var b=0,d=0;d<this.m_files.length;d++)this.m_files[d].row.textInput.value===a&&b++;for(d=0;d<this.m_files.length;d++)this.m_files[d].row.textInput.value===a&&1>=b&&this.m_removeDuplicateError(this.m_files[d])};
c.compiler.Compiler.prototype.m_checkForNewDuplicates=function(a){for(var b=0;b<this.m_files.length;b++)if(this.m_files[b].file.name===a&&!this.m_files[b].file.isDuplicate()){for(var d=0,f=0;f<this.m_view.tableElem.childNodes.length;f++)this.m_view.tableElem.childNodes[f].childNodes[0]===this.m_files[b].row.element&&(d=f);this.m_addDuplicateError(this.m_files[b],d)}};
c.compiler.Compiler.prototype.m_addDuplicateError=function(a,b){a.file.setStatus=2;if(void 0===a.message||null===a.message){var d=new c.compiler.Message(this.m_view.tableElem);d.create(this.m_view.tableElem,b);a.message=d}a.message.addMessage(2);a.file.hasWarning()?a.row.m_styleRow(5):a.row.m_styleRow(2);this.m_incrementException(2)};
c.compiler.Compiler.prototype.m_removeDuplicateError=function(a){a.message.containsDuplicateErr()&&(a.message.removeDup(),a.file.removeError(2));-1<a.file.status.indexOf(10)&&a.row.m_styleRow(10);this.m_decrementException(2);0===a.file.status.length&&(a.message.tbody.parentNode.removeChild(a.message.tbody),a.message=null,a.row.tds[4].classList.contains("coll-active")&&a.row.tds[4].classList.remove("coll-active"),a.row.m_styleRow(0))};c.system.Main=function(){function a(a){b.project=a;b.project.init()}var b={projectManager:null,project:null,init:function(){b.projectManager=new c.project.ProjectManager(a);b.projectManager.init()}};window.addEventListener("load",b.init);return b}();"undefined"!==typeof window&&"undefined"===typeof window.birka&&(window.birka=c);}).call(this);
